liste_noms_sp <- read.csv("1. Flore/1.1. Key/Raw/List_species_ENI_with_synonym.csv") %>%
mutate(species=toupper(nom_eni_fusion_trait)) %>%
separate(species,sep=" ",c("GENRE","SP")) %>%
mutate(genus=str_sub(GENRE, 1, 4))%>%
mutate(sp=str_sub(SP, 1, 7)) %>%
mutate(key= paste(genus,sp,sep="")) %>%
dplyr::select(-GENRE,-SP,-genus,-sp) %>%
mutate(nom_eni_fusion_trait_code=key)
library(tidyverse)
liste_noms_sp <- read.csv("1. Flore/1.1. Key/Raw/List_species_ENI_with_synonym.csv") %>%
mutate(species=toupper(nom_eni_fusion_trait)) %>%
separate(species,sep=" ",c("GENRE","SP")) %>%
mutate(genus=str_sub(GENRE, 1, 4))%>%
mutate(sp=str_sub(SP, 1, 7)) %>%
mutate(key= paste(genus,sp,sep="")) %>%
dplyr::select(-GENRE,-SP,-genus,-sp) %>%
mutate(nom_eni_fusion_trait_code=key)
library(tidyverse)
type_cult <- read.csv(file="5. Models_par_clusters_pedoclimatiques/5.2. Models/Raw/dataset_500_ENI_Lea.csv") %>%
dplyr::select(id_parc_an,TypeCulture) %>%
distinct()
bota <- read.csv(file="1. Flore/1.2. Description flore/Raw/Flore_500ENI_without_dupplicates_with_synonyms.csv",sep=",")
traits <- read.csv(file="1. Flore/1.2. Description flore/Raw/Trait_ENI_baseflor_try_V1.2.csv",sep=";",fileEncoding="latin1")
nat_val <- read.csv(file="1. Flore/1.2. Description flore/Raw/Appendix_species_list_v1.csv",sep=";") %>%
dplyr::select(ID_ENI,Messicole,Agrotolerance)
key <- read.csv(file="1. Flore/1.2. Description flore/Raw/key_500_ENI_name_species.csv",sep=",")
un_pct <- read.csv(file="1. Flore/1.2. Description flore/Raw/List_1pc_most_frequent_species.csv",sep=";") %>%
dplyr::select(-x) %>%
left_join(key) %>%
dplyr::select(1,3) %>%
distinct()
bota2 <- bota %>%
dplyr::select(id_parc_an,id_parcelle,annee,nom_eni,total) %>%
pivot_wider(names_from = nom_eni,
values_from = total,
values_fill = 0)
names <- bota2 %>%
dplyr::select(id_parc_an,id_parcelle,annee)
bota_clean <- bota2 %>%
column_to_rownames("id_parc_an")
list_ab_sp <- bota %>%
dplyr::select(nom_eni,total) %>%
group_by(nom_eni) %>%
summarise_all(sum,na.rm=F)
rich <- as_tibble(specnumber(bota_clean)) %>%
cbind(names) %>%
rename(rich_sp = value)
shannon <- diversity(bota_clean,index="shannon")
sol <- read.csv(file="G:/dataset_Genty_et_al_2025_margin_services/3. Pedoclim data/3.1. Cleaning soil data/Raw/ResultatsAnalyseSol_500ENI_2022_Final_newnames.csv",sep=";") %>%
dplyr::select(2,4,7:25) %>%
rename(N_tot = Azote.Dumas.g.kg,
CEC_a = Capacite.d.Echange.Cationique..CEC..mEq.kg,
calc_actif_a = Calcaire.actif..CaCO3....Methode.A.g.kg,
mat_orga = Matieres.Organiques..Carbone.x.1.73..g.kg,
calc_tot = Calcaire.total..CaCO3..g.kg,
pH = pH.eau.pH.units.No.unit,
CEC_b = Capacite.d.Echange.Cationique..CEC..mEq.100.g,
C_orga = Carbone.organique.g.kg,
granulo = Granulometrie...Pratique.de.la.decarbonatation.No.unit.No.unit,
cuivre = Cuivre..Cu..mg.kg,
phosphore_mg_kg = Phosphore.Olsen..P2O5..mg.kg,
cuivre_extract = Cuivre.extractible.EDTA..Cu..mg.kg,
phosphore_g_kg = Phosphore.Olsen..P2O5..g.kg,
calc_actif_b = Calcaire.actif..CaCO3....Methode.B.g.kg) %>%
mutate(CEC_a=as.numeric(CEC_a))
corr_sol <- sol %>%
dplyr::select(id_parcelle,N_tot,limons_grossiers,CEC_a,argiles,limons_fins,sables_fins,pH,CEC_b,sables_grossiers,C_orga,phosphore_g_kg) %>%
column_to_rownames("id_parcelle")
M = cor(corr_sol)
corrplot(M, method="number", type="lower")
library(corrplot)
M = cor(corr_sol)
corrplot(M, method="number", type="lower")
View(sol)
corr_sol <- sol %>%
dplyr::select(id_parcelle,N_tot,limons_grossiers,CEC_a,argiles,limons_fins,sables_fins,pH,CEC_b,sables_grossiers,C_orga,phosphore_g_kg) %>%
column_to_rownames("id_parcelle") %>%
drop_na
M = cor(corr_sol)
corrplot(M, method="number", type="lower")
sol_var <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/clean_soil_var.csv",sep=";")
id_code <- agroenvi %>%
dplyr::select(id_parcelle,code_parcelle,region_biogeo) %>%
distinct()
sol_var <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/clean_soil_var.csv",sep=";")
agroenvi <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/Agroenvironnement.csv",sep=";",fileEncoding="latin1")
sol_var <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/clean_soil_var.csv",sep=";")
sol_var <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/clean_soil_var.csv",sep=",")
sol_var <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/clean_soil_var.csv",sep=",") %>%
dplyr::select(-X)
clim <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/2023-07-12_Sol_climat.csv",sep=";") %>%
left_join(id_code) %>%
dplyr::select(id_parcelle,temp_moy_an,temp_range_an,  precip_an, precip_season) %>%
mutate(id_parcelle=as.character(id_parcelle))
id_code <- agroenvi %>%
dplyr::select(id_parcelle,code_parcelle,region_biogeo) %>%
distinct()
clim <- read.csv(file="3. Pedoclim data/3.2. Clean pedoclimatic variables/Raw/2023-07-12_Sol_climat.csv",sep=";") %>%
left_join(id_code) %>%
dplyr::select(id_parcelle,temp_moy_an,temp_range_an,  precip_an, precip_season) %>%
mutate(id_parcelle=as.character(id_parcelle))
agroenvi <- read.csv(file="3. Pedoclim data/3.3. Field clustering/Raw/Agroenvironnement_new.csv",sep=";")
id_code <- agroenvi %>%
dplyr::select(id_parcelle,code_parcelle,region_biogeo) %>%
distinct()
dataset_500_ENI_Lea <- read.csv("4. Spatial autocorrelation/Raw/dataset_500_ENI_Lea.csv",sep=";")
a=as.matrix(dataset_500_ENI_Lea[,c("coord_x", "coord_y")]) #sélectionne juste les x et y
b= as.data.frame(project(a, "+proj=longlat", "+proj=utm +zone=31 +units=m")) # transforme les x et y en km
names(b) = c("x_utm", "y_utm") # renomme les coord_x et coord_y pour les différencier des long-lat
dataset_500_ENI_Lea = cbind(dataset_500_ENI_Lea, b) # ajoute les coord en km à notre dataset
var1=variogram(entomogame_1~1, loc=~x_utm+y_utm, dataset_500_ENI_Lea) #fait le variogramme pour voir à partir de quand nos données ne sont plus significativement similaires
library(ade4)
library(adespatial)
library(sp)
library(adegraphics)
library(spdep)
library(tidyverse)
library (gstat)
library (terra)
b= as.data.frame(project(a, "+proj=longlat", "+proj=utm +zone=31 +units=m")) # transforme les x et y en km
dataset_500_ENI_Lea <- read.csv("4. Spatial autocorrelation/Raw/dataset_500_ENI_Lea.csv",sep=";")
b= as.data.frame(project(a, "+proj=longlat", "+proj=utm +zone=31 +units=m")) # transforme les x et y en km
dataset_500_ENI_LeaV <- read.csv("4. Spatial autocorrelation/Raw/dataset_500_ENI_Lea.csv",sep=";")
dataset_500_ENI_Lea <- read.csv("4. Spatial autocorrelation/Raw/dataset_500_ENI_Lea.csv",sep=";")
a=as.matrix(dataset_500_ENI_Lea[,c("coord_x", "coord_y")]) #sélectionne juste les x et y
b= as.data.frame(project(a, "+proj=longlat", "+proj=utm +zone=31 +units=m")) # transforme les x et y en km
names(b) = c("x_utm", "y_utm") # renomme les coord_x et coord_y pour les différencier des long-lat
dataset_500_ENI_Lea = cbind(dataset_500_ENI_Lea, b) # ajoute les coord en km à notre dataset
var1=variogram(entomogame_1~1, loc=~x_utm+y_utm, dataset_500_ENI_Lea) #fait le variogramme pour voir à partir de quand nos données ne sont plus significativement similaires
plot(var1)
fit.variogram(var1, vgm("Exp"), fit.ranges=TRUE)
View(dataset_500_ENI_Lea)
fit.variogram(var1, vgm("Exp"), fit.ranges=TRUE)
a=as.matrix(dataset_500_ENI_Lea[,c("coord_x", "coord_y")]) #sélectionne juste les x et y
b= as.data.frame(project(a, "+proj=longlat", "+proj=utm +zone=31 +units=m")) # transforme les x et y en km
names(b) = c("x_utm", "y_utm") # renomme les coord_x et coord_y pour les différencier des long-lat
dataset_500_ENI_Lea = cbind(dataset_500_ENI_Lea, b) # ajoute les coord en km à notre dataset
var1=variogram(entomogame_1~1, loc=~x_utm+y_utm, dataset_500_ENI_Lea) #fait le variogramme pour voir à partir de quand nos données ne sont plus significativement similaires
plot(var1)
fit.variogram(var1, vgm("Exp"), fit.ranges=TRUE)
